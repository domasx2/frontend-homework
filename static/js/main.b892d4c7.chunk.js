(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{17:function(e,t,n){e.exports=n(24)},23:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(11),l=n.n(c),o=n(9),u=n(1),s=function(e){var t=e.onUpload;return a.a.createElement("input",{type:"file",placeholder:"select text files",onChange:function(e){return e.target.files&&t(Array.from(e.target.files))},multiple:!0,accept:"text/plain"})},i=n(16),f={result:null,loading:!1,settled:!1,error:null};function m(e){var t=Object(r.useState)(f),n=Object(u.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){var t={current:!1};return e?(c(Object(i.a)({},f,{loading:!0})),e.then((function(e){t.current||c({result:e,loading:!1,settled:!0})})).catch((function(e){t.current||c({result:null,loading:!1,error:e,settled:!1})}))):c(f),function(){t.current=!0}}),[e]),a}function d(e){return e.text().then((function(t){return{file:e,lines:new Set(t.split(/\r?\n/).map((function(e){return e.trim()})).filter((function(e){return!!e})))}}))}var p=function(e){var t=e.files;return a.a.createElement("ul",null,t.map((function(e){var t=e.file,n=e.lines;return a.a.createElement("li",{key:t.name},t.name," (",n.size," emails)")})))},v=n(5),b=n.n(v),E=n(8),j=n(12),O=n(14),g=n(13),h=n(15),k=function(e){Object(g.a)(n,e);var t=Object(O.a)(n);function n(e,r){var a;return Object(j.a)(this,n),(a=t.call(this,e)).failedEmails=void 0,a.failedEmails=r,a}return n}(Object(h.a)(Error));var y=function(e){var t=e.error;return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",{className:"error"},t.message),t instanceof k?a.a.createElement("ul",{className:"error"},t.failedEmails.map((function(e){return a.a.createElement("li",{key:e},e)}))):null)};var w=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],c=t[1];console.log(n);var l=function(e){return m(Object(r.useMemo)((function(){return e?Promise.all(e.map(d)):null}),[e]))}(n),i=function(e){var t=Object(r.useState)(null),n=Object(u.a)(t,2),a=n[0],c=n[1];Object(r.useEffect)((function(){return c(null)}),e);var l=m(a),o=l.result,s=l.error,i=l.loading,f=Object(r.useCallback)(function(){var e=Object(E.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c(Object(E.a)(b.a.mark((function e(){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://frontend-homework.togglhire.vercel.app/api/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emails:Array.from(t)})});case 2:if(r=e.sent,e.t0=r,!(null===(n=r.headers.get("Content-Type"))||void 0===n?void 0:n.includes("application/json"))){e.next=10;break}return e.next=7,r.json();case 7:e.t1=e.sent,e.next=11;break;case 10:e.t1=null;case 11:return e.t2=e.t1,e.abrupt("return",{response:e.t0,content:e.t2});case 13:case"end":return e.stop()}}),e)})))()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(r.useMemo)((function(){var e=s||((null===o||void 0===o?void 0:o.content)&&500===o.response.status?new k(o.content.error,o.content.emails):!1===(null===o||void 0===o?void 0:o.response.ok)?new Error("Unexpected API response, code ".concat(null===o||void 0===o?void 0:o.response.status)):void 0);return[f,{loading:i,success:!!(null===o||void 0===o?void 0:o.response.ok),error:e}]}),[f,o,s,i])}([l]),f=Object(u.a)(i,2),v=f[0],j=f[1],O=j.error,g=j.success,h=j.loading;return a.a.createElement(a.a.Fragment,null,a.a.createElement(s,{onUpload:c}),l.result&&a.a.createElement(p,{files:l.result}),l.error&&a.a.createElement("p",{className:"error"},"Error reading files: ",l.error.message),g&&a.a.createElement("p",{className:"success"},"Emails sent! Yay!"),O&&a.a.createElement(y,{error:O}),l.result&&!g&&a.a.createElement("button",{disabled:h,onClick:function(){if(l.result){var e=l.result.reduce((function(e,t){return[].concat(Object(o.a)(e),Object(o.a)(Array.from(t.lines)))}),[]);v(new Set(e))}}},h?"Sending...":"Send emails"))};n(23);l.a.render(a.a.createElement(w,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.b892d4c7.chunk.js.map